{
  "v": "1",
  "id": "f9c182a5-773a-4a67-a87e-60d80a0d2c03",
  "rev": 6,
  "name": "Veilid",
  "summary": "Single glass of pain for veilid-server 0.3.0",
  "description": "Processing pipeline and simple dashboard for monitoring Veilid debug logs. This is just a first attempt and is definitely not handling all possible debug logs, just the stuff that I saw over the course of a day.\n\nIf you want to drop the non-Veilid logs coming in, edit the \"Drop Non-Veilid Messages\" rule in stage 0 of the Veilid Processing pipeline and remove \"&& false\" from the when condition.",
  "vendor": "BourbonInExile",
  "url": "https://github.com/waab76/Graylog-Home-Lab/tree/main/veilid-server_processing",
  "parameters": [],
  "entities": [
    {
      "v": "1",
      "type": {
        "name": "dashboard",
        "version": "2"
      },
      "id": "ac29df9d-3ca5-46bb-b9b3-cf7f0abfb857",
      "data": {
        "summary": {
          "@type": "string",
          "@value": ""
        },
        "search": {
          "queries": [
            {
              "id": "7caa0333-c4c5-4081-a2f3-182d8d571cf7",
              "timerange": {
                "from": 300,
                "type": "relative"
              },
              "filters": [],
              "query": {
                "type": "elasticsearch",
                "query_string": ""
              },
              "search_types": [
                {
                  "query": {
                    "type": "elasticsearch",
                    "query_string": "event_source_product: veilid-server"
                  },
                  "name": null,
                  "timerange": {
                    "from": 300,
                    "type": "relative"
                  },
                  "offset": 0,
                  "streams": [],
                  "filter": null,
                  "decorators": [],
                  "type": "messages",
                  "id": "4f33cdbc-bfe2-4104-bfaa-c1ed3910437d",
                  "limit": 150,
                  "filters": []
                },
                {
                  "query": {
                    "type": "elasticsearch",
                    "query_string": "event_source_product: veilid-server AND _exists_: vendor_event_category"
                  },
                  "name": "chart",
                  "timerange": {
                    "from": 86400,
                    "type": "relative"
                  },
                  "column_limit": null,
                  "streams": [],
                  "row_limit": null,
                  "series": [
                    {
                      "type": "count",
                      "id": "Count",
                      "field": "vendor_event_category"
                    }
                  ],
                  "filter": null,
                  "rollup": true,
                  "row_groups": [
                    {
                      "type": "values",
                      "fields": [
                        "vendor_event_category"
                      ],
                      "limit": 25,
                      "skip_empty_values": false
                    },
                    {
                      "type": "values",
                      "fields": [
                        "vendor_event_action"
                      ],
                      "limit": 25,
                      "skip_empty_values": false
                    }
                  ],
                  "type": "pivot",
                  "id": "c554046a-db8f-43fd-b656-c3295da9cc75",
                  "filters": [],
                  "column_groups": [],
                  "sort": [
                    {
                      "type": "series",
                      "field": "count(vendor_event_category)",
                      "direction": "Descending"
                    }
                  ]
                },
                {
                  "query": {
                    "type": "elasticsearch",
                    "query_string": "event_source_product: veilid-server AND _exists_: vendor_event_category"
                  },
                  "name": "chart",
                  "timerange": {
                    "from": 86400,
                    "type": "relative"
                  },
                  "column_limit": null,
                  "streams": [],
                  "row_limit": null,
                  "series": [
                    {
                      "type": "count",
                      "id": "Count",
                      "field": "vendor_event_action"
                    }
                  ],
                  "filter": null,
                  "rollup": false,
                  "row_groups": [
                    {
                      "type": "values",
                      "fields": [
                        "vendor_event_category",
                        "vendor_event_action"
                      ],
                      "limit": 15,
                      "skip_empty_values": false
                    }
                  ],
                  "type": "pivot",
                  "id": "013eadba-ca80-46e9-a3e9-bb489f61b537",
                  "filters": [],
                  "column_groups": [
                    {
                      "type": "values",
                      "fields": [
                        "source"
                      ],
                      "limit": 15,
                      "skip_empty_values": false
                    }
                  ],
                  "sort": []
                }
              ]
            },
            {
              "id": "73acc9bd-7bce-4057-8d33-781e9e5acd5a",
              "timerange": {
                "from": 300,
                "type": "relative"
              },
              "filters": [],
              "query": {
                "type": "elasticsearch",
                "query_string": ""
              },
              "search_types": [
                {
                  "query": {
                    "type": "elasticsearch",
                    "query_string": "event_source_product: veilid-server AND _exists_: veilid_connection_id"
                  },
                  "name": "chart",
                  "timerange": {
                    "from": 86400,
                    "type": "relative"
                  },
                  "column_limit": null,
                  "streams": [],
                  "row_limit": null,
                  "series": [
                    {
                      "type": "count",
                      "id": "count",
                      "field": "event_source_product"
                    }
                  ],
                  "filter": null,
                  "rollup": true,
                  "row_groups": [
                    {
                      "type": "values",
                      "fields": [
                        "veilid_node_id",
                        "vendor_event_category",
                        "vendor_event_action"
                      ],
                      "limit": 15,
                      "skip_empty_values": false
                    }
                  ],
                  "type": "pivot",
                  "id": "9cba395f-1670-431d-b16b-29c9ceccbf34",
                  "filters": [],
                  "column_groups": [],
                  "sort": [
                    {
                      "type": "series",
                      "field": "count(event_source_product)",
                      "direction": "Descending"
                    }
                  ]
                },
                {
                  "query": {
                    "type": "elasticsearch",
                    "query_string": "event_source_product: veilid-server AND _exists_: veilid_conn_debug"
                  },
                  "name": "chart",
                  "timerange": {
                    "from": 86400,
                    "type": "relative"
                  },
                  "column_limit": null,
                  "streams": [],
                  "row_limit": null,
                  "series": [],
                  "filter": null,
                  "rollup": true,
                  "row_groups": [
                    {
                      "type": "values",
                      "fields": [
                        "timestamp",
                        "vendor_event_category",
                        "vendor_event_action",
                        "veilid_conn_debug"
                      ],
                      "limit": 10,
                      "skip_empty_values": false
                    }
                  ],
                  "type": "pivot",
                  "id": "9b03e77f-209b-431e-8df3-d6ddb635caaa",
                  "filters": [],
                  "column_groups": [],
                  "sort": [
                    {
                      "type": "pivot",
                      "field": "timestamp",
                      "direction": "Descending"
                    }
                  ]
                },
                {
                  "query": {
                    "type": "elasticsearch",
                    "query_string": "event_source_product: veilid-server AND _exists_:vendor_event_category"
                  },
                  "name": "chart",
                  "timerange": {
                    "from": 300,
                    "type": "relative"
                  },
                  "column_limit": null,
                  "streams": [],
                  "row_limit": null,
                  "series": [
                    {
                      "type": "count",
                      "id": "count(vendor_event_category)",
                      "field": "vendor_event_category"
                    }
                  ],
                  "filter": null,
                  "rollup": false,
                  "row_groups": [
                    {
                      "type": "values",
                      "fields": [
                        "vendor_event_category",
                        "vendor_event_action"
                      ],
                      "limit": 15,
                      "skip_empty_values": false
                    }
                  ],
                  "type": "pivot",
                  "id": "8311bf18-adcd-4995-a4ee-375be522cdc8",
                  "filters": [],
                  "column_groups": [
                    {
                      "type": "values",
                      "fields": [
                        "source"
                      ],
                      "limit": 15,
                      "skip_empty_values": false
                    }
                  ],
                  "sort": []
                }
              ]
            }
          ],
          "parameters": [],
          "requires": {},
          "owner": "admin",
          "created_at": "2024-03-30T15:23:03.519Z"
        },
        "created_at": "2024-03-29T21:08:24.469Z",
        "requires": {},
        "state": {
          "7caa0333-c4c5-4081-a2f3-182d8d571cf7": {
            "selected_fields": null,
            "static_message_list_id": null,
            "titles": {
              "tab": {
                "title": "Overview"
              },
              "widget": {
                "a562e93b-32c0-4541-93bb-2b0c2621d674": "Top Category-Action",
                "590da1ff-24e9-4513-ba0c-8df7fbff12b7": "Category-Action by Host",
                "196e6ffe-f60b-4e90-a4bf-8cd64be514fa": "Most Recent Logs"
              }
            },
            "widgets": [
              {
                "id": "196e6ffe-f60b-4e90-a4bf-8cd64be514fa",
                "type": "messages",
                "filter": null,
                "filters": [],
                "timerange": {
                  "from": 300,
                  "type": "relative"
                },
                "query": {
                  "type": "elasticsearch",
                  "query_string": "event_source_product: veilid-server"
                },
                "streams": [],
                "config": {
                  "fields": [
                    "timestamp",
                    "source",
                    "vendor_event_severity",
                    "vendor_event_category",
                    "vendor_event_action",
                    "message"
                  ],
                  "show_message_row": false,
                  "show_summary": false,
                  "decorators": [],
                  "sort": [
                    {
                      "type": "pivot",
                      "field": "timestamp",
                      "direction": "Descending"
                    }
                  ]
                }
              },
              {
                "id": "590da1ff-24e9-4513-ba0c-8df7fbff12b7",
                "type": "aggregation",
                "filter": null,
                "filters": [],
                "timerange": {
                  "from": 86400,
                  "type": "relative"
                },
                "query": {
                  "type": "elasticsearch",
                  "query_string": "event_source_product: veilid-server AND _exists_: vendor_event_category"
                },
                "streams": [],
                "config": {
                  "visualization": "bar",
                  "column_limit": 15,
                  "event_annotation": false,
                  "row_limit": 15,
                  "row_pivots": [
                    {
                      "fields": [
                        "vendor_event_category",
                        "vendor_event_action"
                      ],
                      "type": "values",
                      "config": {
                        "limit": 15
                      }
                    }
                  ],
                  "series": [
                    {
                      "config": {
                        "name": "Count"
                      },
                      "function": "count(vendor_event_action)"
                    }
                  ],
                  "rollup": false,
                  "column_pivots": [
                    {
                      "fields": [
                        "source"
                      ],
                      "type": "values",
                      "config": {
                        "limit": 15
                      }
                    }
                  ],
                  "visualization_config": {
                    "barmode": "stack",
                    "axis_type": "linear"
                  },
                  "formatting_settings": null,
                  "sort": []
                }
              },
              {
                "id": "a562e93b-32c0-4541-93bb-2b0c2621d674",
                "type": "aggregation",
                "filter": null,
                "filters": [],
                "timerange": {
                  "from": 86400,
                  "type": "relative"
                },
                "query": {
                  "type": "elasticsearch",
                  "query_string": "event_source_product: veilid-server AND _exists_: vendor_event_category"
                },
                "streams": [],
                "config": {
                  "visualization": "table",
                  "column_limit": null,
                  "event_annotation": false,
                  "row_limit": 25,
                  "row_pivots": [
                    {
                      "fields": [
                        "vendor_event_category"
                      ],
                      "type": "values",
                      "config": {
                        "limit": 25
                      }
                    },
                    {
                      "fields": [
                        "vendor_event_action"
                      ],
                      "type": "values",
                      "config": {
                        "limit": 25
                      }
                    }
                  ],
                  "series": [
                    {
                      "config": {
                        "name": "Count"
                      },
                      "function": "count(vendor_event_category)"
                    }
                  ],
                  "rollup": true,
                  "column_pivots": [],
                  "visualization_config": {
                    "pinned_columns": []
                  },
                  "formatting_settings": null,
                  "sort": [
                    {
                      "type": "series",
                      "field": "count(vendor_event_category)",
                      "direction": "Descending"
                    }
                  ]
                }
              }
            ],
            "widget_mapping": {
              "196e6ffe-f60b-4e90-a4bf-8cd64be514fa": [
                "4f33cdbc-bfe2-4104-bfaa-c1ed3910437d"
              ],
              "590da1ff-24e9-4513-ba0c-8df7fbff12b7": [
                "013eadba-ca80-46e9-a3e9-bb489f61b537"
              ],
              "a562e93b-32c0-4541-93bb-2b0c2621d674": [
                "c554046a-db8f-43fd-b656-c3295da9cc75"
              ]
            },
            "positions": {
              "a562e93b-32c0-4541-93bb-2b0c2621d674": {
                "col": 1,
                "row": 1,
                "height": 4,
                "width": 4
              },
              "590da1ff-24e9-4513-ba0c-8df7fbff12b7": {
                "col": 5,
                "row": 1,
                "height": 4,
                "width": 8
              },
              "196e6ffe-f60b-4e90-a4bf-8cd64be514fa": {
                "col": 1,
                "row": 5,
                "height": 5,
                "width": "Infinity"
              }
            },
            "formatting": {
              "highlighting": []
            },
            "display_mode_settings": {
              "positions": {}
            }
          },
          "73acc9bd-7bce-4057-8d33-781e9e5acd5a": {
            "selected_fields": null,
            "static_message_list_id": null,
            "titles": {
              "tab": {
                "title": "Experimental"
              },
              "widget": {
                "dd8087f8-35bb-4204-bdcd-ef521023b388": "Category-Action by Host",
                "4b368ff0-c4fb-4b52-ac03-c5af271b7437": "Most Seen Node IDs",
                "abd7da38-06ef-4d80-8c4f-0147017c3969": "Most Recent Connection Debug Strings"
              }
            },
            "widgets": [
              {
                "id": "dd8087f8-35bb-4204-bdcd-ef521023b388",
                "type": "aggregation",
                "filter": null,
                "filters": [],
                "timerange": {
                  "from": 300,
                  "type": "relative"
                },
                "query": {
                  "type": "elasticsearch",
                  "query_string": "event_source_product: veilid-server AND _exists_:vendor_event_category"
                },
                "streams": [],
                "config": {
                  "visualization": "heatmap",
                  "column_limit": 15,
                  "event_annotation": false,
                  "row_limit": 15,
                  "row_pivots": [
                    {
                      "fields": [
                        "vendor_event_category",
                        "vendor_event_action"
                      ],
                      "type": "values",
                      "config": {
                        "limit": 15
                      }
                    }
                  ],
                  "series": [
                    {
                      "config": {
                        "name": null
                      },
                      "function": "count(vendor_event_category)"
                    }
                  ],
                  "rollup": false,
                  "column_pivots": [
                    {
                      "fields": [
                        "source"
                      ],
                      "type": "values",
                      "config": {
                        "limit": 15
                      }
                    }
                  ],
                  "visualization_config": {
                    "color_scale": "RdBu",
                    "reverse_scale": false,
                    "auto_scale": true,
                    "z_min": null,
                    "z_max": null,
                    "default_value": null,
                    "use_smallest_as_default": false
                  },
                  "formatting_settings": null,
                  "sort": []
                }
              },
              {
                "id": "4b368ff0-c4fb-4b52-ac03-c5af271b7437",
                "type": "aggregation",
                "filter": null,
                "filters": [],
                "timerange": {
                  "from": 86400,
                  "type": "relative"
                },
                "query": {
                  "type": "elasticsearch",
                  "query_string": "event_source_product: veilid-server AND _exists_: veilid_connection_id"
                },
                "streams": [],
                "config": {
                  "visualization": "table",
                  "column_limit": null,
                  "event_annotation": false,
                  "row_limit": 15,
                  "row_pivots": [
                    {
                      "fields": [
                        "veilid_node_id",
                        "vendor_event_category",
                        "vendor_event_action"
                      ],
                      "type": "values",
                      "config": {
                        "limit": 15
                      }
                    }
                  ],
                  "series": [
                    {
                      "config": {
                        "name": "count"
                      },
                      "function": "count(event_source_product)"
                    }
                  ],
                  "rollup": false,
                  "column_pivots": [],
                  "visualization_config": {
                    "pinned_columns": []
                  },
                  "formatting_settings": null,
                  "sort": [
                    {
                      "type": "series",
                      "field": "count(event_source_product)",
                      "direction": "Descending"
                    }
                  ]
                }
              },
              {
                "id": "abd7da38-06ef-4d80-8c4f-0147017c3969",
                "type": "aggregation",
                "filter": null,
                "filters": [],
                "timerange": {
                  "from": 86400,
                  "type": "relative"
                },
                "query": {
                  "type": "elasticsearch",
                  "query_string": "event_source_product: veilid-server AND _exists_: veilid_conn_debug"
                },
                "streams": [],
                "config": {
                  "visualization": "table",
                  "column_limit": null,
                  "event_annotation": false,
                  "row_limit": 10,
                  "row_pivots": [
                    {
                      "fields": [
                        "timestamp",
                        "vendor_event_category",
                        "vendor_event_action",
                        "veilid_conn_debug"
                      ],
                      "type": "values",
                      "config": {
                        "limit": 10
                      }
                    }
                  ],
                  "series": [],
                  "rollup": false,
                  "column_pivots": [],
                  "visualization_config": {
                    "pinned_columns": []
                  },
                  "formatting_settings": null,
                  "sort": [
                    {
                      "type": "pivot",
                      "field": "timestamp",
                      "direction": "Descending"
                    }
                  ]
                }
              }
            ],
            "widget_mapping": {
              "dd8087f8-35bb-4204-bdcd-ef521023b388": [
                "8311bf18-adcd-4995-a4ee-375be522cdc8"
              ],
              "abd7da38-06ef-4d80-8c4f-0147017c3969": [
                "9b03e77f-209b-431e-8df3-d6ddb635caaa"
              ],
              "4b368ff0-c4fb-4b52-ac03-c5af271b7437": [
                "9cba395f-1670-431d-b16b-29c9ceccbf34"
              ]
            },
            "positions": {
              "dd8087f8-35bb-4204-bdcd-ef521023b388": {
                "col": 1,
                "row": 1,
                "height": 4,
                "width": 4
              },
              "4b368ff0-c4fb-4b52-ac03-c5af271b7437": {
                "col": 5,
                "row": 1,
                "height": 4,
                "width": 8
              },
              "abd7da38-06ef-4d80-8c4f-0147017c3969": {
                "col": 1,
                "row": 5,
                "height": 4,
                "width": "Infinity"
              }
            },
            "formatting": {
              "highlighting": []
            },
            "display_mode_settings": {
              "positions": {}
            }
          }
        },
        "properties": [],
        "owner": "admin",
        "title": {
          "@type": "string",
          "@value": "Veilid"
        },
        "type": "DASHBOARD",
        "description": {
          "@type": "string",
          "@value": ""
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.2.5+7eaa89d"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "input",
        "version": "1"
      },
      "id": "153b7a7c-e2c9-4677-a4d3-17a7aa6b22ea",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Veilid Syslog"
        },
        "configuration": {
          "tls_key_file": {
            "@type": "string",
            "@value": ""
          },
          "port": {
            "@type": "integer",
            "@value": 12201
          },
          "tls_enable": {
            "@type": "boolean",
            "@value": false
          },
          "use_null_delimiter": {
            "@type": "boolean",
            "@value": false
          },
          "recv_buffer_size": {
            "@type": "integer",
            "@value": 1048576
          },
          "tcp_keepalive": {
            "@type": "boolean",
            "@value": false
          },
          "force_rdns": {
            "@type": "boolean",
            "@value": false
          },
          "allow_override_date": {
            "@type": "boolean",
            "@value": true
          },
          "tls_client_auth_cert_file": {
            "@type": "string",
            "@value": ""
          },
          "bind_address": {
            "@type": "string",
            "@value": "0.0.0.0"
          },
          "tls_cert_file": {
            "@type": "string",
            "@value": ""
          },
          "expand_structured_data": {
            "@type": "boolean",
            "@value": false
          },
          "max_message_size": {
            "@type": "integer",
            "@value": 2097152
          },
          "store_full_message": {
            "@type": "boolean",
            "@value": false
          },
          "tls_client_auth": {
            "@type": "string",
            "@value": "disabled"
          },
          "timezone": {
            "@type": "string",
            "@value": "UTC"
          },
          "charset_name": {
            "@type": "string",
            "@value": "UTF-8"
          },
          "number_worker_threads": {
            "@type": "integer",
            "@value": 4
          },
          "tls_key_password": {
            "@type": "string",
            "@value": ""
          }
        },
        "static_fields": {},
        "type": {
          "@type": "string",
          "@value": "org.graylog2.inputs.syslog.tcp.SyslogTCPInput"
        },
        "global": {
          "@type": "boolean",
          "@value": true
        },
        "extractors": []
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.2.5+7eaa89d"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline",
        "version": "1"
      },
      "id": "5c6da5c1-7e82-4775-bee5-e4d4df2c3a1f",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Veilid Processing"
        },
        "description": {
          "@type": "string",
          "@value": "Process data coming from Veilid via Syslog"
        },
        "source": {
          "@type": "string",
          "@value": "pipeline \"Veilid Processing\"\nstage 0 match either\nrule \"Select Veilid Messages\"\nrule \"Drop Non-Veilid Messages\"\nstage 10 match either\nrule \"Parse Syslog Log Level 0\"\nrule \"Parse Syslog Log Level 1\"\nrule \"Parse Syslog Log Level 2\"\nrule \"Parse Syslog Log Level 3\"\nrule \"Parse Syslog Log Level 4\"\nrule \"Parse Syslog Log Level 5\"\nrule \"Parse Syslog Log Level 6\"\nrule \"Parse Syslog Log Level 7\"\nrule \"Drop Syslog Facility Fields\"\nstage 20 match either\nrule \"Veilid Parse Bucket Kick\"\nrule \"Veilid Parse Connection Accepted\"\nrule \"Veilid Parse Connection Closed\"\nrule \"Veilid Parse Connection Protect\"\nrule \"Veilid Parse Dead Route Failed\"\nrule \"Veilid Parse Get or Create Connection Retry\"\nrule \"Veilid Parse LRU Kill\"\nrule \"Veilid Parse RPC Drop\"\nrule \"Veilid Parse RPC Get Value\"\nrule \"Veilid Parse RPC Inspect Value\"\nrule \"Veilid Parse RPC Lost\"\nrule \"Veilid Parse RPC Set Value\"\nrule \"Veilid Parse RPC Watch Value\"\nrule \"Veilid Parse Receipt\"\nrule \"Veilid Parse Routing Table Update\"\nrule \"Veilid Parse SingleShot Receipt\"\nrule \"Veilid Parse Timestamp Ahead/Behind\"\nrule \"Veilid Parse RPC Failure\"\nrule \"Veilid Parse No Protocol Handler\"\nrule \"Veilid Parse Get Peer Address Fail\"\nrule \"Veilid Parse Dialinfo Failure\"\nrule \"Veilid Parse Dialinfo Permit\"\nrule \"Veilid Parse Forgive\"\nrule \"Veilid Parse Punish\"\nrule \"Veilid Parse Can't Add Dial Info\"\nrule \"Veilid Parse Websocket Error\"\nend"
        },
        "connected_streams": [
          {
            "@type": "string",
            "@value": "cbbee2b2-e168-4813-ad4e-0f9458e2d819"
          }
        ]
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.2.5+7eaa89d"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "a38e98b6-921e-4801-883f-8255e04ed1c1",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Drop Non-Veilid Messages"
        },
        "description": {
          "@type": "string",
          "@value": ""
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Drop Non-Veilid Messages\"\nwhen\n    has_field(\"application_name\")\n    && to_string($message.application_name) != \"veilid-server\"\n    && false\nthen\n    drop_message();\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.2.5+7eaa89d"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "f83e078e-b387-49a7-90d3-d214b3007a8d",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Veilid Parse RPC Set Value"
        },
        "description": {
          "@type": "string",
          "@value": ""
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Veilid Parse RPC Set Value\"\nwhen\n    starts_with(to_string($message.message), \"IN <=== SetValueQ\")\nthen\n    set_field(\"vendor_event_category\", \"rpc\");\n    set_field(\"vendor_event_action\", \"set\");\n    set_fields(grok(\"IN <=== SetValueQ\\\\(%{GREEDYDATA:veilid_key} #{GREEDYDATA:veilid_subkey} len=%NUMBER:veilid_data_length} seq=%{DATA:veilid_seq} writer=%{GREEDYDATA:veilid_writer}\\\\) <== %{GREEDYDATA:veilid_sender_node_id}\", to_string($message.message), true));\nend\n"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.2.5+7eaa89d"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "0c1d1719-93f0-4bd2-9158-383305a24444",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Select Veilid Messages"
        },
        "description": {
          "@type": "string",
          "@value": ""
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Select Veilid Messages\"\nwhen\n    has_field(\"application_name\")\n    && to_string($message.application_name) == \"veilid-server\"\nthen\n    rename_field(\"application_name\", \"event_source_product\");\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.2.5+7eaa89d"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "c4ef39c7-2c39-474a-9b1d-ea4787386faf",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Veilid Parse Get or Create Connection Retry"
        },
        "description": {
          "@type": "string",
          "@value": ""
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Veilid Parse Get or Create Connection Retry\"\nwhen\n    starts_with(to_string($message.message), \"get_or_create_connection retries left\", true)\nthen\n    // https://gitlab.com/veilid/veilid/-/blob/main/veilid-core/src/network_manager/connection_manager.rs#L360\n    set_field(\"vendor_event_category\", \"connection\");\n    set_field(\"vendor_event_action\", \"retry\");\n    set_fields(grok(\"get_or_create_connection retries left: %{NUMBER:retries_left}\", to_string($message.message), true));\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.2.5+7eaa89d"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "934407c0-1b3e-4a6b-86e4-e01e3c29b456",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Parse Syslog Log Level 7"
        },
        "description": {
          "@type": "string",
          "@value": ""
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Parse Syslog Log Level 7\"\nwhen\n    has_field(\"level\") && to_string($message.level) == \"7\"\nthen\n    set_field(\"vendor_event_severity\", \"debug\");\n    rename_field(\"level\", \"vendor_event_severity_level\");\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.2.5+7eaa89d"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "afc20fd2-395e-46a6-877d-eed7dc0b6136",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Parse Syslog Log Level 4"
        },
        "description": {
          "@type": "string",
          "@value": ""
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Parse Syslog Log Level 4\"\nwhen\n    has_field(\"level\") && to_string($message.level) == \"4\"\nthen\n    set_field(\"vendor_event_severity\", \"medium\");\n    rename_field(\"level\", \"vendor_event_severity_level\");\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.2.5+7eaa89d"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "547a0668-29bb-4b75-aae1-205d20916b72",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Veilid Parse RPC Inspect Value"
        },
        "description": {
          "@type": "string",
          "@value": ""
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Veilid Parse RPC Inspect Value\"\nwhen\n    starts_with(to_string($message.message), \"IN <=== InspectValueQ\")\nthen\n    // https://gitlab.com/veilid/veilid/-/blob/main/veilid-core/src/rpc_processor/rpc_inspect_value.rs#L207\n    set_field(\"vendor_event_category\", \"rpc\");\n    set_field(\"vendor_event_action\", \"inspect\");\n    set_fields(grok(\"IN <=== InspectValueQ\\\\(%{GREEDYDATA:veilid_key} {GREEDYDATA:veilid_subkey}\\\\) <== %{GREEDYDATA:veilid_sender_node_id}\", to_string($message.message), true));\nend\n"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.2.5+7eaa89d"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "00c41e1b-31b3-4ea7-a7ee-eb6d93935946",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Veilid Parse No Protocol Handler"
        },
        "description": {
          "@type": "string",
          "@value": ""
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Veilid Parse No Protocol Handler\"\nwhen\n    starts_with(to_string($message.message), \"no protocol handler for connection from\")\nthen\n    // https://gitlab.com/veilid/veilid/-/blob/main/veilid-core/src/network_manager/native/network_tcp.rs#L221\n    set_field(\"vendor_event_category\", \"network\");\n    set_field(\"vendor_event_action\", \"drop\");\n    set_field(\"vendor_event_outcome\", \"failed\");\n    set_fields(grok(\"no protocol handler for connection from %{IPORHOST:remote_ip}:%{NUMBER:remote_port}\", to_string($message.message), true));\nend\n    "
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.2.5+7eaa89d"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "7c3fbd1f-e847-4cd2-81b4-9c574866737c",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Drop Syslog Facility Fields"
        },
        "description": {
          "@type": "string",
          "@value": ""
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Drop Syslog Facility Fields\"\nwhen\n    has_field(\"facility\") && has_field(\"facility_num\")\nthen\n    remove_field(\"facility\");\n    remove_field(\"facility_num\");\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.2.5+7eaa89d"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "c3bfadd8-f6f6-4147-9426-b4b0597d4355",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Veilid Parse Connection Closed"
        },
        "description": {
          "@type": "string",
          "@value": ""
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Veilid Parse Connection Closed\"\nwhen\n    starts_with(to_string($message.message), \"Connection closed\", true)\nthen\n    set_field(\"vendor_event_category\", \"connection\");\n    set_field(\"vendor_event_action\", \"close\");\n    set_fields(grok(\"Connection closed from: %{IPORHOST:remote_ip}:%{NUMBER:remote_port} \\\\(%{WORD:network_transport}\\\\)\", to_string($message.message), true));\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.2.5+7eaa89d"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "332e3059-e4da-434d-8ddc-abe391fc9755",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Veilid Parse Connection Protect"
        },
        "description": {
          "@type": "string",
          "@value": ""
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Veilid Parse Connection Protect\"\nwhen\n    starts_with(to_string($message.message), \"== PROTECTING connection\")\nthen\n    set_field(\"vendor_event_category\", \"connection\");\n    set_field(\"vendor_event_action\", \"protect\");\n    set_fields(grok(\"== PROTECTING connection: %{NUMBER:veilid_connection_id} -> %{GREEDYDATA:veilid_conn_debug} for node %{GREEDYDATA:veilid_node_id}\", to_string($message.message), true));\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.2.5+7eaa89d"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "2ca5fe8a-a904-45da-8f13-42b04e4f4dfc",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Parse Syslog Log Level 3"
        },
        "description": {
          "@type": "string",
          "@value": ""
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Parse Syslog Log Level 3\"\nwhen\n    has_field(\"level\") && to_string($message.level) == \"3\"\nthen\n    set_field(\"vendor_event_severity\", \"high\");\n    rename_field(\"level\", \"vendor_event_severity_level\");\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.2.5+7eaa89d"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "73ca7bd8-b1fa-4ca1-9876-4d9e7f44e8ad",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Veilid Parse LRU Kill"
        },
        "description": {
          "@type": "string",
          "@value": ""
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Veilid Parse LRU Kill\"\nwhen\n    starts_with(to_string($message.message), \"== LRU kill connection\")\nthen\n    // https://gitlab.com/veilid/veilid/-/blob/main/veilid-core/src/network_manager/connection_manager.rs#L231\n    set_field(\"vendor_event_category\", \"connection\");\n    set_field(\"vendor_event_action\", \"kill\");\n    set_fields(grok(\"== LRU kill connection due to limit: %{GREEDYDATA:veilid_conn_debug}\", to_string($message.message), true));\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.2.5+7eaa89d"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "0b07f9fe-299b-4b26-9239-4401bd92d5c3",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Veilid Parse Timestamp Ahead/Behind"
        },
        "description": {
          "@type": "string",
          "@value": ""
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Veilid Parse Timestamp Ahead/Behind\"\nwhen\n    starts_with(to_string($message.message), \"Timestamp behind\")\n    || starts_with(to_string($message.message), \"Timestamp ahead\")\nthen\n    // https://gitlab.com/veilid/veilid/-/blob/main/veilid-core/src/network_manager/mod.rs#L965\n    set_field(\"vendor_event_category\", \"time\");\n    set_field(\"vendor_event_action\", \"check\");\n    set_fields(grok(\"Timestamp %{WORD:vendor_event_outcome}: %{NUMBER:millis_behind}ms \\\\(%{WORD:network_transport}:%{IPORHOST:destination_ip}:%{NUMBER:destination_port}\\\\)\", to_string($message.message), true));\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.2.5+7eaa89d"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "42bee18f-c898-4500-83d0-1f542cde4572",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Parse Syslog Log Level 5"
        },
        "description": {
          "@type": "string",
          "@value": ""
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Parse Syslog Log Level 5\"\nwhen\n    has_field(\"level\") && to_string($message.level) == \"5\"\nthen\n    set_field(\"vendor_event_severity\", \"low\");\n    rename_field(\"level\", \"vendor_event_severity_level\");\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.2.5+7eaa89d"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "140779d0-3192-4fb5-968a-8e0afcb859e8",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Veilid Parse RPC Get Value"
        },
        "description": {
          "@type": "string",
          "@value": ""
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Veilid Parse RPC Get Value\"\nwhen\n    starts_with(to_string($message.message), \"IN <=== GetValueQ\")\nthen\n    set_field(\"vendor_event_category\", \"rpc\");\n    set_field(\"vendor_event_action\", \"get\");\n    set_fields(grok(\"IN <=== GetValueQ\\\\(%{GREEDYDATA:veilid_key} #{GREEDYDATA:veilid_subkey}\\\\) <== %{GREEDYDATA:veilid_sender_node_id}\", to_string($message.message), true));\nend\n"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.2.5+7eaa89d"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "797b678d-cdb8-46aa-9a8e-f74f162a6980",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Veilid Parse Dialinfo Permit"
        },
        "description": {
          "@type": "string",
          "@value": ""
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Veilid Parse Dialinfo Permit\"\nwhen\n    starts_with(to_string($message.message), \">>> DIALINFO PERMIT\")\nthen\n    set_field(\"vendor_event_category\", \"dial_info\");\n    set_field(\"vendor_event_action\", \"permit\");\n    set_fields(grok(\">>> DIALINFO PERMIT: %{GREEDYDATA:veilid_dial_info}\", to_string($message.message), true));\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.2.5+7eaa89d"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "1a6da639-ceb5-4c02-a660-fd8f49efffdb",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Parse Syslog Log Level 0"
        },
        "description": {
          "@type": "string",
          "@value": ""
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Parse Syslog Log Level 0\"\nwhen\n    has_field(\"level\") && to_string($message.level) == \"0\"\nthen\n    set_field(\"vendor_event_severity\", \"emergency\");\n    rename_field(\"level\", \"vendor_event_severity_level\");\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.2.5+7eaa89d"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "5b7ea93b-3987-4d4b-b10c-fe6e0119ed0a",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Veilid Parse RPC Drop"
        },
        "description": {
          "@type": "string",
          "@value": ""
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Veilid Parse RPC Drop\"\nwhen\n    starts_with(to_string($message.message), \"Dropping RPC Operation\")\nthen\n    set_field(\"vendor_event_category\", \"rpc\");\n    set_field(\"vendor_event_action\", \"drop\");\n    set_fields(grok(\"Dropping RPC Operation: \\\\[%{GREEDYDATA:vendor_event_outcome_reason}]\", to_string($message.message), true));\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.2.5+7eaa89d"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "c3c4c672-a583-4fb0-9767-2a4f1e80b692",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Veilid Parse RPC Failure"
        },
        "description": {
          "@type": "string",
          "@value": ""
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Veilid Parse RPC Failure\"\nwhen\n    starts_with(to_string($message.message), \"couldn't process rpc message\")\nthen\n    // https://gitlab.com/veilid/veilid/-/blob/main/veilid-core/src/rpc_processor/mod.rs#L1697\n    set_field(\"vendor_event_category\", \"rpc\");\n    set_field(\"vendor_event_action\", \"process\");\n    set_field(\"vendor_event_outcome\", \"failed\");\n    set_fields(grok(\"couldn't process rpc message:%{GREEDYDATA:vendor_event_outcome_reason}\", to_string($message.message), true));\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.2.5+7eaa89d"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "b56bd323-0a9e-4357-8c6e-2fe9e884a7ea",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Veilid Parse Can't Add Dial Info"
        },
        "description": {
          "@type": "string",
          "@value": ""
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Veilid Parse Can't Add Dial Info\"\nwhen\n    to_string($message.message) == \"can not add dial info to this routing domain\"\nthen\n    // https://gitlab.com/veilid/veilid/-/blob/main/veilid-core/src/routing_table/routing_table_inner.rs#L167\n    set_field(\"vendor_event_category\", \"dial_info\");\n    set_field(\"vendor_event_action\", \"add\");\n    set_field(\"vendor_event_outcome\", \"failed\");\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.2.5+7eaa89d"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "5b1278ea-2420-4c5f-b004-07bb93cd2151",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Veilid Parse Get Peer Address Fail"
        },
        "description": {
          "@type": "string",
          "@value": ""
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Veilid Parse Get Peer Address Fail\"\nwhen\n    starts_with(to_string($message.message), \"failed to get peer address\")\nthen\n    // https://gitlab.com/veilid/veilid/-/blob/main/veilid-core/src/network_manager/native/network_tcp.rs#L117\n    set_field(\"vendor_event_category\", \"network\");\n    set_field(\"vendor_event_action\", \"resolve\");\n    set_field(\"vendor_event_outcome\", \"failed\");\n    set_fields(grok(\"failed to get peer address: %{GREEDYDATA:error_message}\", to_string($message.message), true));\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.2.5+7eaa89d"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "b8aff8c1-9144-459a-86a8-3bca936cbd20",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Veilid Parse RPC Watch Value"
        },
        "description": {
          "@type": "string",
          "@value": ""
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Veilid Parse RPC Watch Value\"\nwhen\n    starts_with(to_string($message.message), \"IN <=== WatchValueQ\")\nthen\n    // https://gitlab.com/veilid/veilid/-/blob/main/veilid-core/src/rpc_processor/rpc_watch_value.rs#L235\n    set_field(\"vendor_event_category\", \"rpc\");\n    set_field(\"vendor_event_action\", \"watch\");\n    // set_fields(grok(\"IN <=== WatchValueQ\\\\(%{GREEDYDATA:veilid_key} #{GREEDYDATA:veilid_subkey}\\\\) <== %{GREEDYDATA:veilid_sender_node_id}\", to_string($message.message), true));\nend\n"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.2.5+7eaa89d"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "628a44d7-07a3-49ed-9c5c-1edf7ed0ac49",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Parse Syslog Log Level 2"
        },
        "description": {
          "@type": "string",
          "@value": ""
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Parse Syslog Log Level 2\"\nwhen\n    has_field(\"level\") && to_string($message.level) == \"2\"\nthen\n    set_field(\"vendor_event_severity\", \"critical\");\n    rename_field(\"level\", \"vendor_event_severity_level\");\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.2.5+7eaa89d"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "467e4314-ccad-45bd-9015-27ee670d6b19",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Veilid Parse Routing Table Update"
        },
        "description": {
          "@type": "string",
          "@value": ""
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Veilid Parse Routing Table Update\"\nwhen\n    starts_with(to_string($message.message), \"Routing table now has\", true)\nthen\n    set_field(\"vendor_event_category\", \"routing\");\n    set_field(\"vendor_event_action\", \"update\");\n    set_fields(grok(\"Routing table now has %{NUMBER:veilid_routing_total_nodes} nodes, %{NUMBER:veilid_routing_live_nodes} live\", to_string($message.message), true));\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.2.5+7eaa89d"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "b7a1cb72-dfe6-4a52-8989-7924c57a00bc",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Veilid Parse Punish"
        },
        "description": {
          "@type": "string",
          "@value": ""
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Veilid Parse Punish\"\nwhen\n    starts_with(to_string($message.message), \">>> PUNISHED:\")\nthen\n    set_field(\"vendor_event_category\", \"punishment\");\n    set_field(\"vendor_event_action\", \"punish\");\n    // Punishment could be on node or IP\n    // node - https://gitlab.com/veilid/veilid/-/blob/main/veilid-core/src/network_manager/address_filter.rs#L327\n    // IP - https://gitlab.com/veilid/veilid/-/blob/main/veilid-core/src/network_manager/address_filter.rs#L279\n    set_fields(grok(\">>> PUNISHED: %{GREEDYDATA:veilid_punished}\", to_string($message.message), true));\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.2.5+7eaa89d"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "777ac29d-493f-41a6-a5a3-d18a7727586d",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Veilid Parse SingleShot Receipt"
        },
        "description": {
          "@type": "string",
          "@value": ""
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Veilid Parse SingleShot Receipt\"\nwhen\n    starts_with(to_string($message.message), \"== New SingleShot Receipt\")\nthen\n    set_field(\"vendor_event_category\", \"SingleShot\");\n    set_field(\"vendor_event_action\", \"receive\");\n    set_fields(grok(\"== New SingleShot Receipt %{GREEDYDATA:veilid_receipt_nonce}\", to_string($message.message), true));\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.2.5+7eaa89d"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "14a38e4d-b7b3-4ee7-821c-d980003526cf",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Veilid Parse Receipt"
        },
        "description": {
          "@type": "string",
          "@value": ""
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Veilid Parse Receipt\"\nwhen\n    starts_with(to_string($message.message), \"<<== RECEIPT\")\nthen\n    // https://gitlab.com/veilid/veilid/-/blob/main/veilid-core/src/network_manager/receipt_manager.rs#L415\n    set_field(\"vendor_event_category\",\"rpc\");\n    set_field(\"vendor_event_action\", \"receive\");\n    set_fields(grok(\"<<== RECEIPT %{DATA:veilid_receipt_nonce} <- %{GREEDYDATA:veilid_receipt_details}\", to_string($message.message), true));\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.2.5+7eaa89d"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "8bc04670-0b53-4248-929a-2c607d186028",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Veilid Parse Connection Accepted"
        },
        "description": {
          "@type": "string",
          "@value": ""
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Veilid Parse Connection Accepted\"\nwhen\n    starts_with(to_string($message.message), \"Connection accepted\", true)\nthen\n    set_field(\"vendor_event_category\", \"connection\");\n    set_field(\"vendor_event_action\", \"accept\");\n    set_fields(grok(\"Connection accepted from: %{IPORHOST:remote_ip}:%{NUMBER:remote_port} \\\\(%{WORD:network_transport}\\\\)\", to_string($message.message), true));\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.2.5+7eaa89d"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "16160958-b76b-4b3a-a71f-ee92525b4dcd",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Parse Syslog Log Level 6"
        },
        "description": {
          "@type": "string",
          "@value": ""
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Parse Syslog Log Level 6\"\nwhen\n    has_field(\"level\") && to_string($message.level) == \"6\"\nthen\n    set_field(\"vendor_event_severity\", \"informational\");\n    rename_field(\"level\", \"vendor_event_severity_level\");\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.2.5+7eaa89d"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "a696323b-fcc9-4d19-877b-bf4892fdfd26",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Veilid Parse Websocket Error"
        },
        "description": {
          "@type": "string",
          "@value": ""
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Veilid Parse Websocket Error\"\nwhen\n    to_string($message.message) == \"websocket start_send error: WebSocket protocol error: Sending after closing is not allowed\"\nthen\n    set_field(\"vendor_event_category\", \"websocket\");\n    set_field(\"vendor_event_action\", \"send\");\n    set_field(\"vendor_event_outcome\", \"failed\");\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.2.5+7eaa89d"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "6fd3c1ac-7b8d-4593-8529-1c22c3f831de",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Veilid Parse RPC Lost"
        },
        "description": {
          "@type": "string",
          "@value": ""
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Veilid Parse RPC Lost\"\nwhen\n    starts_with(to_string($message.message), \"RPC Lost\")\nthen\n    set_field(\"vendor_event_category\", \"rpc\");\n    set_field(\"vendor_event_action\", \"lost\");\n    set_fields(grok(\"RPC Lost \\\\(%{GREEDYDATA:debug_string}\\\\): %{GREEDYDATA:vendor_event_outcome_reason}\", to_string($message.message), true));\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.2.5+7eaa89d"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "77c3530c-505a-4f5e-ae93-3fa9dd999b9c",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Veilid Parse Dialinfo Failure"
        },
        "description": {
          "@type": "string",
          "@value": ""
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Veilid Parse Dialinfo Failure\"\nwhen\n    starts_with(to_string($message.message), \">>> DIALINFO FAILURE\")\nthen\n    set_field(\"vendor_event_category\", \"dial_info\");\n    set_field(\"vendor_event_action\", \"fail\");\n    set_fields(grok(\">>> DIALINFO %{DATA:vendor_event_outcome}: %{GREEDYDATA:veilid_dial_info}\", to_string($message.message), true));\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.2.5+7eaa89d"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "017b83b8-af94-414f-98bb-6e2044e5bd80",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Veilid Parse Dead Route Failed"
        },
        "description": {
          "@type": "string",
          "@value": ""
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Veilid Parse Dead Route Failed\"\nwhen\n    starts_with(to_string($message.message), \"Dead route failed to test\")\nthen\n    // https://gitlab.com/veilid/veilid/-/blob/main/veilid-core/src/routing_table/tasks/private_route_management.rs#L166\n    set_field(\"vendor_event_category\", \"route\");\n    set_field(\"vendor_event_action\", \"test\");\n    set_field(\"vendor_event_outcome\", \"failed\");\n    set_fields(grok(\"Dead route failed to test: %{GREEDYDATA:veilid_route}\", to_string($message.message), true));\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.2.5+7eaa89d"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "b26f6ae8-c595-48a1-a285-e86e2b47dc43",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Parse Syslog Log Level 1"
        },
        "description": {
          "@type": "string",
          "@value": ""
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Parse Syslog Log Level 1\"\nwhen\n    has_field(\"level\") && to_string($message.level) == \"1\"\nthen\n    set_field(\"vendor_event_severity\", \"alert\");\n    rename_field(\"level\", \"vendor_event_severity_level\");\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.2.5+7eaa89d"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "2f589e34-ca8f-4c41-bc97-431433377718",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Veilid Parse Forgive"
        },
        "description": {
          "@type": "string",
          "@value": ""
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Veilid Parse Forgive\"\nwhen\n    starts_with(to_string($message.message), \">>> FORGIVING:\")\nthen\n    set_field(\"vendor_event_category\", \"punishment\");\n    set_field(\"vendor_event_action\", \"forgive\");\n    // Could be node id, ipv4 or ipv6\n    set_fields(grok(\">>> FORGIVING: %{GREEDYDATA:veilid_punished}\", to_string($message.message), true));\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.2.5+7eaa89d"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "835d2dd0-47ce-4c8e-b931-2200bd98c17f",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Veilid Parse Bucket Kick"
        },
        "description": {
          "@type": "string",
          "@value": ""
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Veilid Parse Bucket Kick\"\nwhen\n    starts_with(to_string($message.message), \"Bucket \")\nthen\n    set_field(\"vendor_event_category\", \"routing\");\n    set_field(\"vendor_event_action\", \"kick\");\n    set_fields(grok(\"Bucket %{DATA:veilid_bucket_crypto}:%{DATA:veilid_bucket_size} kicked Routing table now has %{NUMBER:veilid_routing_table_entries} nodes\", to_string($message.message), true));\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.2.5+7eaa89d"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "search",
        "version": "1"
      },
      "id": "95e247eb-7e3c-4aa9-8b41-b6dafc26d66b",
      "data": {
        "summary": {
          "@type": "string",
          "@value": ""
        },
        "search": {
          "queries": [
            {
              "id": "87983d91-412e-4c7d-a76f-5140cb0036ac",
              "timerange": {
                "from": 14400,
                "type": "relative"
              },
              "filters": [],
              "query": {
                "type": "elasticsearch",
                "query_string": "event_source_product: veilid-server AND NOT _exists_: vendor_event_category"
              },
              "search_types": [
                {
                  "query": null,
                  "name": "chart",
                  "timerange": null,
                  "column_limit": null,
                  "streams": [],
                  "row_limit": null,
                  "series": [
                    {
                      "type": "count",
                      "id": "count()",
                      "field": null
                    }
                  ],
                  "filter": null,
                  "rollup": true,
                  "row_groups": [
                    {
                      "type": "time",
                      "fields": [
                        "timestamp"
                      ],
                      "interval": {
                        "type": "auto",
                        "scaling": 1
                      }
                    }
                  ],
                  "type": "pivot",
                  "id": "3b32085c-c928-448c-8369-15ac39b10228",
                  "filters": [],
                  "column_groups": [],
                  "sort": []
                },
                {
                  "query": null,
                  "name": null,
                  "timerange": null,
                  "offset": 0,
                  "streams": [],
                  "filter": null,
                  "decorators": [],
                  "type": "messages",
                  "id": "150eea4d-420f-49ef-8ff0-c39d0d2a7e5f",
                  "limit": 150,
                  "filters": []
                }
              ]
            }
          ],
          "parameters": [],
          "requires": {},
          "owner": "admin",
          "created_at": "2024-03-30T02:01:24.212Z"
        },
        "created_at": "2024-03-29T22:31:44.487Z",
        "requires": {},
        "state": {
          "87983d91-412e-4c7d-a76f-5140cb0036ac": {
            "selected_fields": null,
            "static_message_list_id": null,
            "titles": {
              "widget": {
                "bcbeaa31-4160-4dfa-97d4-14edc939f513": "Message Count",
                "4554e170-93eb-4ca2-84d6-3150076f97c4": "All Messages"
              }
            },
            "widgets": [
              {
                "id": "bcbeaa31-4160-4dfa-97d4-14edc939f513",
                "type": "aggregation",
                "filter": null,
                "filters": [],
                "timerange": null,
                "query": null,
                "streams": [],
                "config": {
                  "visualization": "bar",
                  "column_limit": null,
                  "event_annotation": false,
                  "row_limit": null,
                  "row_pivots": [
                    {
                      "fields": [
                        "timestamp"
                      ],
                      "type": "time",
                      "config": {
                        "interval": {
                          "type": "auto",
                          "scaling": 1
                        }
                      }
                    }
                  ],
                  "series": [
                    {
                      "config": {
                        "name": null
                      },
                      "function": "count()"
                    }
                  ],
                  "rollup": true,
                  "column_pivots": [],
                  "visualization_config": null,
                  "formatting_settings": null,
                  "sort": []
                }
              },
              {
                "id": "4554e170-93eb-4ca2-84d6-3150076f97c4",
                "type": "messages",
                "filter": null,
                "filters": [],
                "timerange": null,
                "query": null,
                "streams": [],
                "config": {
                  "fields": [
                    "timestamp",
                    "source"
                  ],
                  "show_message_row": true,
                  "show_summary": true,
                  "decorators": [],
                  "sort": [
                    {
                      "type": "pivot",
                      "field": "timestamp",
                      "direction": "Descending"
                    }
                  ]
                }
              }
            ],
            "widget_mapping": {
              "bcbeaa31-4160-4dfa-97d4-14edc939f513": [
                "3b32085c-c928-448c-8369-15ac39b10228"
              ],
              "4554e170-93eb-4ca2-84d6-3150076f97c4": [
                "150eea4d-420f-49ef-8ff0-c39d0d2a7e5f"
              ]
            },
            "positions": {
              "bcbeaa31-4160-4dfa-97d4-14edc939f513": {
                "col": 1,
                "row": 1,
                "height": 2,
                "width": "Infinity"
              },
              "4554e170-93eb-4ca2-84d6-3150076f97c4": {
                "col": 1,
                "row": 3,
                "height": 6,
                "width": "Infinity"
              }
            },
            "formatting": null,
            "display_mode_settings": {
              "positions": {}
            }
          }
        },
        "properties": [],
        "owner": "admin",
        "title": {
          "@type": "string",
          "@value": "Veilid Unparsed"
        },
        "type": "SEARCH",
        "description": {
          "@type": "string",
          "@value": ""
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.2.5+7eaa89d"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "search",
        "version": "1"
      },
      "id": "67de2198-d263-40b7-822c-dc05d12836dc",
      "data": {
        "summary": {
          "@type": "string",
          "@value": ""
        },
        "search": {
          "queries": [
            {
              "id": "b605b869-1cb8-4e7c-9fb9-25d6c1ed62bd",
              "timerange": {
                "from": 1800,
                "type": "relative"
              },
              "filters": [],
              "query": {
                "type": "elasticsearch",
                "query_string": "event_source_product: veilid-server"
              },
              "search_types": [
                {
                  "query": null,
                  "name": "chart",
                  "timerange": null,
                  "column_limit": null,
                  "streams": [],
                  "row_limit": null,
                  "series": [
                    {
                      "type": "count",
                      "id": "count()",
                      "field": null
                    }
                  ],
                  "filter": null,
                  "rollup": true,
                  "row_groups": [
                    {
                      "type": "time",
                      "fields": [
                        "timestamp"
                      ],
                      "interval": {
                        "type": "auto",
                        "scaling": 1
                      }
                    }
                  ],
                  "type": "pivot",
                  "id": "7d0dea2a-18f0-4b30-8f95-ed989dcf9e69",
                  "filters": [],
                  "column_groups": [],
                  "sort": []
                },
                {
                  "query": null,
                  "name": null,
                  "timerange": null,
                  "offset": 0,
                  "streams": [],
                  "filter": null,
                  "decorators": [],
                  "type": "messages",
                  "id": "4c945270-4cb8-4f87-8fc0-0fba9597a326",
                  "limit": 150,
                  "filters": []
                }
              ]
            }
          ],
          "parameters": [],
          "requires": {},
          "owner": "admin",
          "created_at": "2024-03-30T15:22:28.402Z"
        },
        "created_at": "2024-03-30T15:21:06.578Z",
        "requires": {},
        "state": {
          "b605b869-1cb8-4e7c-9fb9-25d6c1ed62bd": {
            "selected_fields": null,
            "static_message_list_id": null,
            "titles": {
              "widget": {
                "90b1012d-8f92-44fd-bf7e-94c4653e695d": "Message Count",
                "62a0e692-b5c9-4b0c-a804-d3d5a7d5cbd1": "All Messages"
              }
            },
            "widgets": [
              {
                "id": "90b1012d-8f92-44fd-bf7e-94c4653e695d",
                "type": "aggregation",
                "filter": null,
                "filters": [],
                "timerange": null,
                "query": null,
                "streams": [],
                "config": {
                  "visualization": "bar",
                  "column_limit": null,
                  "event_annotation": false,
                  "row_limit": null,
                  "row_pivots": [
                    {
                      "fields": [
                        "timestamp"
                      ],
                      "type": "time",
                      "config": {
                        "interval": {
                          "type": "auto",
                          "scaling": 1
                        }
                      }
                    }
                  ],
                  "series": [
                    {
                      "config": {
                        "name": null
                      },
                      "function": "count()"
                    }
                  ],
                  "rollup": true,
                  "column_pivots": [],
                  "visualization_config": null,
                  "formatting_settings": null,
                  "sort": []
                }
              },
              {
                "id": "62a0e692-b5c9-4b0c-a804-d3d5a7d5cbd1",
                "type": "messages",
                "filter": null,
                "filters": [],
                "timerange": null,
                "query": null,
                "streams": [],
                "config": {
                  "fields": [
                    "timestamp",
                    "source"
                  ],
                  "show_message_row": true,
                  "show_summary": true,
                  "decorators": [],
                  "sort": [
                    {
                      "type": "pivot",
                      "field": "timestamp",
                      "direction": "Descending"
                    }
                  ]
                }
              }
            ],
            "widget_mapping": {
              "90b1012d-8f92-44fd-bf7e-94c4653e695d": [
                "7d0dea2a-18f0-4b30-8f95-ed989dcf9e69"
              ],
              "62a0e692-b5c9-4b0c-a804-d3d5a7d5cbd1": [
                "4c945270-4cb8-4f87-8fc0-0fba9597a326"
              ]
            },
            "positions": {
              "90b1012d-8f92-44fd-bf7e-94c4653e695d": {
                "col": 1,
                "row": 1,
                "height": 2,
                "width": "Infinity"
              },
              "62a0e692-b5c9-4b0c-a804-d3d5a7d5cbd1": {
                "col": 1,
                "row": 3,
                "height": 6,
                "width": "Infinity"
              }
            },
            "formatting": {
              "highlighting": []
            },
            "display_mode_settings": {
              "positions": {}
            }
          }
        },
        "properties": [],
        "owner": "admin",
        "title": {
          "@type": "string",
          "@value": "Veilid Events"
        },
        "type": "SEARCH",
        "description": {
          "@type": "string",
          "@value": ""
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.2.5+7eaa89d"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "stream_title",
        "version": "1"
      },
      "id": "cbbee2b2-e168-4813-ad4e-0f9458e2d819",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Default Stream"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.2.5+7eaa89d"
        }
      ]
    }
  ]
}